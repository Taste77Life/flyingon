<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
</head>
<body>

    <div>
        <input type="button" onclick="drawBorderRect()" value="border-rect" />
        <input type="button" onclick="drawRoundRect()" value="round-rect" />
    </div>

    <canvas id="canvas" width="800" height="600" style="width: 800px; height: 600px; background-color: yellow;" />

    <script type="text/javascript">




        function drawBorderRect() {


            var context = canvas.getContext("2d");

            //var date = new Date();

            //for (var i = 0; i < 100; i++)
            //{
            //    for (var j = 0; j < 100; j++)
            //    {
            //        context.beginPath();
            //        this.insideRect(i * 20, j * 20, 18, 18, [2, 4, 6, 8]);
            //        context.fillStyle = "red";
            //        context.fill();
            //    }
            //}

            //alert(new Date() - date);

            context.beginPath();
            this.insideRect(100, 100, 100, 100, [2, 4, 6, 8]);
            context.fillStyle = "red";
            context.fill();
        };

        function insideRect(x, y, width, height, border) {

            var context = canvas.getContext("2d");

            context.beginPath();

            context.rect(x, y, width - border[1], border[0]);
            context.rect(x + width - border[1], y, border[1], height - border[2]);
            context.rect(x + border[3], y + height - border[2], width - border[3], border[2]);
            context.rect(x, y + border[0], border[3], height - border[0]);
        };


        function drawRoundRect() {

            var context = canvas.getContext("2d");


            var date = new Date();

            for (var i = 0; i < 100; i++)
            {
                for (var j = 0; j < 100; j++)
                {
                    context.beginPath();
                    this.roundRect.call(context, i * 20, j * 20, 18, 18, 4);
                    context.strokeStyle = "red";
                    context.stroke();
                }
            }

            alert(new Date() - date);


            //context.beginPath();

            //this.roundRect.call(context, 100, 210, 100, 100, 20, 5);

            //context.strokeStyle = "red";
            //context.lineWidth = 10;
            //context.stroke();
        };

        function roundRect(x, y, width, height, radius, offset) {


            if (radius == null || radius <= 0)
            {
                radius = 8;
            }

            if (offset && offset > 0)
            {
                x += offset;
                y += offset;

                offset = offset << 1;
                width -= offset;
                height -= offset;
            }

            var right = x + width,
                bottom = y + height;

            this.moveTo(x + radius, y);

            this.lineTo(right - radius, y);
            this.quadraticCurveTo(right, y, right, y + radius);

            this.lineTo(right, bottom - radius);
            this.quadraticCurveTo(right, bottom, right - radius, bottom);

            this.lineTo(x + radius, bottom);
            this.quadraticCurveTo(x, bottom, x, bottom - radius);

            this.lineTo(x, y + radius);
            this.quadraticCurveTo(x, y, x + radius, y);

            this.closePath();
        };


    </script>

</body>
</html>
